---
title: "Mock TLFs"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Mock TLFs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, warning=FALSE, message=FALSE}
library(gtreg)
library(tidyverse)
```

# Overview

Mock TLFs can be generated by: 

1. Create dummy data or using your own data.

2. Pass the data to your function of choice.

3. Overwrite the statistic(s) shown to a fixed character string.

# Example `tbl_ae()` TLF

## Dummy data

```{r}
dat_ae <-
  tibble::tibble(
    soc = "System Organ Class 1",
    ae = "AE1",
     grade = factor(1, levels = 1:5)
  ) %>%
  {dplyr::bind_rows(., .)} %>%
  dplyr::mutate(
    id = 1:2,
    strata = c("Arm A", "Arm B")
  )
```

```{r}
dat_ae
```


## TLF 1

Here, we specify the `digits` argument to apply to all summary
statistics in the table; in this case this is both `n` and `%`.

```{r}
dat_ae %>% 
 tbl_ae(
        id = id,
        ae = ae,
        soc = soc,
        by = grade,
        digits = purrr::partial(style_xxx, width = 2)
      ) %>%
      modify_header(all_ae_cols() ~ "**Grade {by}**") %>%
      modify_spanning_header(all_ae_cols() ~ "**N = xx**")
```

# TLF 2

If you want the formatting to differ between `n` and `%`, specify
the `digits` argument with a `list`.

```{r}
dat_ae %>% 
 tbl_ae(
        id = id,
        ae = ae,
        soc = soc,
        by = grade,
        digits =
          list(
            purrr::partial(style_xxx, width = 2), # format n
            purrr::partial(style_xxx, width = 4, digits = 1) # format %
            )
      ) %>%
      modify_header(all_ae_cols() ~ "**Grade {by}**") %>%
      modify_spanning_header(all_ae_cols() ~ "**N = xx**")
```



```{r}
dat_ae  %>%
  tbl_ae(
    id = id,
    ae = ae, 
    soc = soc,
    by = grade, 
    strata = strata, 
    statistic = "xx (xx.x)",
     zero_symbol = NULL
  ) %>%
  modify_spanning_header(all_ae_cols() ~ "**{strata} (N=xx), n (%)**") %>%
  modify_caption("**Incidence and Number of AEs by Maximum Grade (N, %)**") %>%
  bold_labels()
```

# Example `tbl_reg_summary()` TLF

## Dummy data

```{r}
dat_reg <-
  df_patient_characteristics %>% 
  select(trt, marker, status)
```

```{r}
head(dat_reg)
```


## TLF

```{r, error=TRUE}
dat_reg %>% 
  tbl_reg_summary(
    by = trt,
    statistic = list(
      #all_continuous2() ~ "xx (xx.x)",
      #marker = c("xx (xx.x)","xx (xx.x)","xx (xx.x)","xx (xx.x)","xx (xx.x)"  ),
      status = "x (x.x%)"
      )
  ) %>%
  bold_labels()
```
